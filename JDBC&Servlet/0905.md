     * 控制反转: new对象,不一定是工厂模式,通过IOC容器加载,
     * 目前一种:1. XML(<Bean>标签)
     2. 注解注入
     *
     * 依赖注入DI: 给控制反转的对象的属性赋值
     * 目前两种:1. 构造器
     * 2. Setter
          - 集合的注入
          - 组件的注入

# 
## 自定义IOC容器
- class.forname加载对象
- BeanFactory ApllicationContext
## 1.Spring介绍
### 1.1 Spring 是什么
1. Spring是分层的 Java SE/EE应用轻量级开源框架,主要提供两个机制:
     1. IoC, Inverse Of Control,控制反转
     2. AOP, Aspect Oriented Programming,面向切面编程
2. 除了IOC AOP以外,主要是充当`粘合剂`作用,整合了其他框架的各种操作
3. Spring的体系架构(看图)
     1. Data Access
          - JDBC
     2. WEB
          - Servlet
     3. AOP,Aspects等四个
     4. Core Container
          - Beans
          - Core
     5. Test
### 1.2 Spring的使用
1. 创建MAVEN项目
2. 导入JAR包
     - 
3. 创建Beans.xml(Spring配置文件)
### 1.3 代码的耦合
1. 解耦:依赖关系不饿能解除,只能降低,把编译时的依赖推迟到运行时
     1. 类和类之间产生依赖(使用IOC解决)
     2. 方法和方法之间产生依赖(用AOP解决)
2. 举例
- DAO层
```java
public class EmpDaoImpl implements EmpDao {
    @Override
    public void add() {
        System.out.println("ADD");
    }
}
```
- Service层
```java
public class EmpServiceImpl implements EmpService {
     //如果EmpDao不存在,编译时报错,因此EmpServiceImpl依赖于EmpDaoImpl
    EmpDao empDao = (EmpDaoImpl) BeanFactory.getBean("empDao");

    @Override
    public void add() {
        empDao.add();
    }
}
```
### IoC和DI
1. 控制反转IoC: 不适用new关键字,通过IOC容器加载对象,(不一定是工厂模式)
     1. <Bean>标签(XML文件)
     2. 注解
2. 依赖注入DI给控制反转的对象的属性赋值
     1. 构造器注入
     2. Setter注入
3. <Bean>标签(XML文件)的具体实现:
     1. <bean>标签概述
          - 参数相同时,使用`index`来只当调用哪个构造器
          - `scope`

     2. 构造器注入
          - 默认是空构造器
          - <constructor-arg>标签
     ```java
     //现在有两个构造器
     //1.
     public AccountService(int age, String name, Date date) {
        System.out.println("参数一样时,和顺序无关,构造器1");
        this.name = name;
        this.age = age;
        this.date = date;
    }
     //2.
     public AccountService(String name, int age, Date date) {
        System.out.println("用INDEX指定就是要用构造器2");
        this.name = name;
        this.age = age;
        this.date = date;
    }
     ```
     ```xml
     <!-- 引用类型Date也是一个BEAN -->
     <bean id="d" class="java.util.Date"></bean>
     <!-- 构造器1 -->
     <bean id="as1" class="com.gsd.service.AccountService" scope="singleton">
        <!--    对于基本类型和String类型,使用value直接注入    -->
        <constructor-arg name="name" value="石原里美" index="1"/>
        <constructor-arg name="age" value="25" index="1"/>
        <!--    对于引用类型,需要ref    -->
        <constructor-arg name="date" ref="d"/>
    </bean>

     <!-- 构造器2 -->
     <bean id="as2" class="com.gsd.service.AccountService" scope="singleton">
        <constructor-arg name="age" value="25" index="1"/>
        <constructor-arg name="name" value="石原里美" index="0"/>
        <constructor-arg name="date" ref="d"/>
    </bean>
     ```

     3. Setter注入
     - 首先要确保各个属性都有`Setter`
     - 其次必须需要`空构造`,因为默认就是调用空构造,然后再Set
     - <property>标签,可以看作是一个setter方法
     ```xml
     <!--  构造器注入太麻烦了,建议使用set注入,默认是空构造器  -->
    <bean id="as2" class="com.gsd.service.AccountService" scope="prototype">
        <property name="name" value="泽尻绘里香"/>
        <property name="age" value="23"/>
        <property name="date"><!-- 使用内部类的方式 -->
            <bean class="java.util.Date"></bean>
        </property>
    </bean>
     ```
     4. Setter注入的简写,P标签
          - 现在是有三个字段就要写三个Property
          1. 首先导入p空间
          ```xml
          <beans xmlns="http://www.springframework.org/schema/beans"  //默认空间
          xmlns:p="http://www.springframework.org/schema/p"    //名字改成p,前面再加个冒号P即可
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
          <beans>
          ```
          2. 修改之前的Setter注入
          - 注意引用类型`date-ref`的写法
          ```xml
          <bean id="as3" class="com.gsd.service.AccountService" scope="prototype" p:name="星野源" p:age="25" p:date-ref="d">
          </bean>
          ```
     5. 总结
          1. 对于基本类型和String类型,使用`value`直接注入
          2. 对于引用类型,需要`ref`
               1. 在外面建一个Bean
               ```xml
               <bean id="d" class="java.util.Date"></bean>
               ```
               2. 使用内部类的方式
               ```xml
               <property name="date"><!-- 使用内部类的方式 -->
                    <bean class="java.util.Date"></bean>
               </property>
               ```

               3. 集合
               3. 组件
     