#
##
1. 模板字符串
2. EL表达式(在模板字符串里面要加个反斜线?)
## 按钮
1. 注册事件
2. 使用函数
3. Jquery的各种选择器
4. size()已经不能用了
## 
1. 
2. 

##
- 单表的增删改查
- free mybatis tool 插件

## MyBatis动态SQL
1. 多条件查询
    - `<where><if>`
    - test里面是get方法
    ```xml
    <!-- 1. where -->
    SELECT * FROM
        <where>
            <if test="scename!=null and scename!=''">
                <!--scename like '%#{scename}%',当心识别成'%?%'-->
                AND scename like '%${scename}%'
            </if>
            <if test="scetypeid!=null and scetypeid!=0">
                    AND scetypeid = #{scetypeid}
            </if>
        </where>
    ```
2. 选择性添加景点
    - `<trim><if>`
    - 前缀后缀，去掉最后一个逗号(但这也意味着加的最后一个项目后面必须带逗号)
    ```xml
    <!-- 1. where -->
    INSERT INTO travle.t_scenery
        <trim suffixOverrides="," prefix="(" suffix=")">
            <if test="scename!=null and scename!=''">
                scename,
            </if>
        </trim>

        <trim suffixOverrides="," prefix="VALUES (" suffix=")">
            <if test="scename!=null and scename!=''">
                #{scename},
            </if>
        </trim>
    ```
3. 选择性修改景点
    - UPDATE专用的`set`,动态sql的`<set><if>`可以自动去掉内部最后一个逗号
    - 最后一个项目后面也一定要带逗号
    ```xml
    UPDATE travle.t_scenery
        <set>
            <if test="scename!=null and scename!=''">
                scename = #{scename},
            </if>
        </set>
    WHERE sceid = #{sceid};
    ```
4. 批量删除<foreach
    - collection表示遍历的的对象,可以是数组和List
    - 数组就写array,如果是List就写list
    - open遍历前添加内容
    - close遍历后添加内容
    - item:遍历项
    - separator:分隔符号,最后一个不加分隔符号
    ```xml
    <delete id="batchDelete">
        <foreach collection="array" open="DELETE FROM t_scenery  WHERE sceid IN (" close=")" item="sceid" separator=",">
            ${sceid}
        </foreach>
    </delete>
    ```

4. sql代码片段，把一段sql定义成一个变量
    - `<sql id="baseScenery">`<include refid="baseScenery"/>`
    ```xml
    <sql id="baseScenery">
        sceid,scename,scetypeid,context,pic,recommend,areaid,ticket,favorite,season,collection,sce_grade,location,start_time,tic_count
    </sql>

    <!--  sql代码片段,使用例  -->
    <select id="findSceneryBysceid" resultType="Scenery">
        select <include refid="baseScenery"/>
        from t_scenery
        WHERE sceid = #{sceid}
    </select>
    ```
5. Mapper里面的class的别名
    - beans里面
    ```xml
    <bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">
        <!--    5.mapper 文件class的别名    -->
        <!--    com.gsd.entity.Scenery ->  Scenery   -->
        <property name="typeAliasesPackage" value="com.gsd.entity"/>
    </bean>
    ```
6. 

## 全选
1. html
    - check的`value和checked`
        1. value:表示checkbox提交给表单的值,
            - 不设置的话默认是`on`,设置之后提交设置的值
            - 这个值`on`本身与是否被check`无关`,但只有被check住了才会向表单提交这个`value` `on`,否则为空
        2. checked: `checked`,只要出现在html里就表示选中,后面的值没有意义,`checked=false`也会在刷新后表示选中
            - 判断标准: `document.getElementById("checkbox1").checked`返回值为true还是false
        3. 补充:可以在表单提交前判断所有checkbox的状态
    ```html
    <!-- 表头 -->
    <tr>
        <th><input type="checkbox" id="all"></th>
        <!-- 其他列 -->
    </tr>
    <!-- 每一行 -->
    <tr>
        <td><input type="checkbox" name="rowCheck" value="${scenery.sceid}"></td>
        <!-- 其他列 -->
        <td>
            <button class="btn btn-danger btn-sm" onclick="delScenery(${scenery.sceid})">
                <span class="glyphicon glyphicon-trash"></span>删除
            </button>
        <td>
    </tr>            
    ```
2. javascript
    1. 左上角的全选与取消
        - 用`this.checked`替换每一行的checkbox的属性
        ```javascript
        $('#all').on('click',function(){
            $('[name=rowCheck]').prop('checked',this.checked)
        })
        ```
    2. 当选中当前页所有行时,把左上角的也选中
        - 当所有被check的长度等于行数时
        ```javascript
        $('[name=sceid]').on('click',function(){
            //alert($('[name=sceid]',$('table')[0]).length)//表示范围,下面这左右两种写法效果一样
            $('#all').prop('checked',$('table [name=rowCheck]:checked').length===$('[name=rowCheck]',$('table')[0]).length)
        })
        ```        
## 批量删除
1. 判断有没有行被选中
2. `确认框`:确认操作
3. 如果选确定的话,执行删除
    1. 把选中的checkbox的value拼接成字符串
    2. 发送结果
    3. 接收返回结果并显示`结果框`
    ```html
    <button type="button" class="btn btn-primary btn-default" onclick="batchDelete()">
        批量删除
    </button>
    ```
    ```javascript
    //批量删除
    function batchDelete(){
        //1.判断有没有选中的
        if($('table [name=sceid]:checked').length==0){
            bootbox.alert({ //异步对话框,alert是同步的
                message: '没有景点被选中',
                size: 'small',
            });
            return  //直接返回,什么也不做
        }
        //2.有选中行时,提示确认框(确认和取消)
        bootbox.confirm({
            title: '确认操作',
            message: '确认要删除吗?',
            buttons: {
                cancel: {
                    label: '<i class="glyphicon glyphicon-remove"></i> 取消'
                },
                confirm: {
                    label: '<i class="glyphicon glyphicon-ok"></i> 确定'
                }
            },
            //3.在`确认框`的回调函数里面执行删除,result时bootbox的功能
            callback: function (result) {
                //3.判断是否点了确定
                if(result){
                    //3.1.拼接成id
                    let sceidStr=''
                    $('table [name=sceid]:checked').each(function(i,scenery){
                        sceidStr+=scenery.value+","
                    })
                    sceidStr = sceidStr.slice(0,-1) //删除最后一个逗号
                    console.log(sceidStr)
                    //3.2.发送请求,逗号转数组
                    $.ajax({
                        url:`${pageContext.request.contextPath}/scenery/batchDelete?sceids=\${sceidStr}`,
                        success(data){  //发送请求后的回调函数
                            //1.在得到结果后,提示信息
                            bootbox.alert({ //异步对话框,alert是同步的
                                title:'结果',
                                message: data.message,
                                size: 'small',
                                callback() {    //`结果框`的回调函数
                                    if(data.success){
                                        //3.刷新页面
                                        location.reload()
                                    }
                                }
                            });
                        }
                    })
                }//点取消的话什么也不做
            }
        })
    }
    ```    


