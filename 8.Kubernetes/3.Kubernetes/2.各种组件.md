# K8s组件
## 基础组件
1. Node
    1. 相当于`一个虚拟机`或者物理机
    2. Node中运行多个Pod,分别运行应用程序和数据库
2. Pod(容器集)
    - 比如一个`应用程序Pod`和一个数据库Pod
    1. `最小调度单元`,可以是一个或多个应用容器(一般是一个),创建一个容器的运行环境
        1. 有一个Pod,为`共享卷`中的文件提供`Web服务器`支持,还有一个`边车容器`负责从远端更新这些文件
        1. sidecar边车模式,将一个主要容器和一个辅助容器放入一个Pod
            - 比如记录日志等等功能
    2. 容器在这里`共享`网络,存储,等等配置
        - 提供一个`内部IP地址`,Pod之间就是通过这个内部IP地址进行通讯的
        - Pod内部的绒癌可以使用localhost相互通讯
    3. Pod不是一个稳定的实体,很容易创建或者销毁(比如发生故障的时候)
        - 这意味着外部`不能只通过内部IP`来查询服务
3. Service(svc),在Node内部
    1. 将一组Pod封装成一个服务,并提供一个统一入口进行访问
    2. 内部服务与外部服务
        - 这意味着一个Node里可能有两个以上的svc
        1. 内部服务
            1. 可以当作内部交换机,应用Pod通过svc来访问可用的数据库Pod
            2. 外部也不能访问数据库,缓存,消息队列等
        2. 外部服务
            1. 连接外部与应用APP
            2. 外部服务的类型
                1. node:port
                    - 在Node上开放一个端口,然后把这个端口映射到Service的IP地址和端口上
                    - 开发环境可以,但生产环境应该通过域名来访问
    3. 一个Cluster的多个Node之间也是依靠Service来进行通讯的
4. Ingress(ing),在Node内部
    1. 用来管理从集群外部访问`集群内部的入口`和方式的
        - 将外部请求的路由,转发到内部的Service上
    2. 也可以通过Ingress来`配置域名`,这样也可以访问Service
    3. 还可以配置负载均衡和`SSL证书`
5.  ConfigMap,Secret,以及其他`安全机制`
    - 应用程序要访问数据库的话,需要URL,user,pw等信息,
    - 由于Pod会变,因此这些信息不应该写死在应用Pod里 
    1. ConfigMap可以将配置信息独立出来,从而保持容器化APP的可移植性
    2. 但是ConfigMap是明文的,可以使用Secret来存储敏感信息
6. Volumes
    1. 和Docker的一样,用于将持久化存储的资源挂在到集群的本地磁盘上,或者外部的远程存储上
## 高可用性组件
1. Deployment
    - Pod的扩容能力
    1. 希望能使用多个节点,将一个节点的东西复制几份,共用一个service,
        - 这样一个node坏了,就转移到另一个节点上
    2. Deployment
        1. 可以管理应用程序的副本数量以及应用程序的更新策略
        2. 从而简化应用程序的部署和更新操作
    3. 理解
        1. Pod相当于在容器上面加了一层抽象,从而将一个多个容器组合在一起
        2. Demployment相当于在Pod上面加一层抽象,从而将一个多个Pod组合在一起
    4. 有副本控制(控制副本的数量),滚动更新,自动伸缩等功能
    5. Deployment通过ReplicaSet(副本集)控制Pod的数量
        - 可以设置运行Pod的数量,通常在Deployment中声明ReplocaSet
2. StatefulSet(sts)
    - 数据库也需要多副本来保证高可用性,但一般不使用Deployment
    - 这是因为数据库是有状态的,需要保证多个副本之间的数据一致
    - 因此需要把数据写入一个存储,或者数据共享
    1. 数据库,缓存,消息队列,以及保留会话状态的应用程序需要使用这个
    2. 但是更推荐将数据库等有状态的应用程序从K8s中剥离出来单独部署,生产环境也不推荐将数据库放在容器里
## 


